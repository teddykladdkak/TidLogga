<!DOCTYPE html>
<html>
<head>
	<title>TidLogga</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="yes" name="mobile-web-app-capable" />
	<meta content="minimum-scale=1.0, width=device-width, maximum-scale=0.6667, user-scalable=no" name="viewport" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<script type="application/javascript" src="config.js"></script>
	<script type="text/javascript">
		function load(){
			var logininput = document.getElementById('idnamn');
				logininput.focus();
				logininput.select();
			for (var i = 0; i < config.elemtohide.length; i++){
				document.getElementById(config.elemtohide[i]).setAttribute('style', 'display: none;');
			};
		};
		function removechilds(parent){while (parent.hasChildNodes()) {parent.removeChild(parent.firstChild);};};
		function showhide(hide, show){if(hide == 'none'){}else{document.getElementById(hide).setAttribute('style', 'display: none;');};if(show == 'none'){}else{document.getElementById(show).removeAttribute('style');};};
		var removeError;
		function adderror(id, text){
			var error = document.getElementById(id);
				removeerror(id);
				var errortext = document.createTextNode(text);
				error.appendChild(errortext);
				clearTimeout(removeError);
				removeError = setTimeout(function(){ removeerror(id); }, 3000);
		};
		function removeerror(id){
			var error = document.getElementById(id);
			removechilds(error);
		};
		function disablebuttons(id){
			var utelem = document.getElementsByClassName(id);
			for (var i = utelem.length - 1; i >= 0; i--) {
				var klickfunc = utelem[i].getAttribute('onclick');
				if(!klickfunc){}else{
					utelem[i].setAttribute('data-onclick', klickfunc);
					utelem[i].disabled = true;
				};
			};
		};
		function enablebuttons(id){
			var inelem = document.getElementsByClassName(id);
			for (var i = inelem.length - 1; i >= 0; i--) {
				var klickfunc = inelem[i].getAttribute('data-onclick');
				if(!klickfunc){}else{
					inelem[i].setAttribute('onclick', klickfunc);
					inelem[i].disabled = false;
				};
			};
		};
		function addzero(number){if(number <= 9){return "0" + number;}else{return number;};};
		function timebetween(start, stop, millisec){
			if(!millisec){
				var sekunder = parseInt(stop) / 1000 - parseInt(start) / 1000;
			}else{
				var sekunder = parseInt(millisec) / 1000;
			};
			var t = Math.floor(sekunder / 3600);
			var m = Math.floor((sekunder / 60) - (t * 60));
			var s = Math.floor(sekunder - (m * 60) - (t * 3600));
			return {"t": t, "m": m, "s": s};
		};
		function backtostandard(element, standard){removechilds(element);var text = document.createTextNode(standard);element.appendChild(text);};
		var countinterval;
		function startcount(){
			var tidraknare = document.getElementById('tid');
			var inmilisec = tidraknare.getAttribute('data-milisec');
			var numilisec = getDate().milisec;
			var timecalc = timebetween(inmilisec, numilisec);
			removechilds(tidraknare);
			var tidraknaretext = document.createTextNode(addzero(timecalc.t) + ':' + addzero(timecalc.m) + ':' + addzero(timecalc.s));
			tidraknare.appendChild(tidraknaretext);
		};
		function getDate(dateannan, timeannan, milisecsave){
			if(!dateannan && !timeannan && !milisecsave){
				var date = new Date();
			}else if(!milisecsave){
				var annatdatum = dateannan.split('-');
				var annattid = timeannan.split(':');
				var date = new Date(annatdatum[0], annatdatum[1] - 1, annatdatum[2], annattid[0], annattid[1]);
			}else{
				console.log(milisecsave);
				var date = new Date(parseInt(milisecsave));
			};
			var y = date.getFullYear();
			var m = date.getMonth() + 1;
			var d = date.getDate();
			var h = date.getHours();
			var mm = date.getMinutes();
			var milisec = date.getTime();
			var datum = y + '-' + addzero(m) + '-' + addzero(d);
			var tid = addzero(h) + ':' + addzero(mm);
			return {"datum": datum, "tid": tid, "milisec": milisec};
		};
		function tillbakatillprojekt(){
			clearInterval(countinterval);
			var projektnamn = document.getElementById('projektnamn');
				backtostandard(projektnamn, 'XXXXXXXXX');
				showhide('projektnamn', 'none');
			var intid = document.getElementById('intid');
				backtostandard(intid, 'XX:XX');
			var tid = document.getElementById('tid');
				backtostandard(tid, 'XX:XX:XX');
				tid.removeAttribute('data-milisec');
				tid.removeAttribute('data-projektid');
			showhide('klocka', 'projekt');
		};
		function annantid(todo){
			showhide('klocka', 'klockaannantid');
			var button = document.getElementById('annantidbutton');
			if(todo == 'in'){
				button.setAttribute('value', 'Klocka in');
				button.setAttribute('onclick', 'startclock("annat")');
			}else if(todo == 'ut'){
				button.setAttribute('value', 'Klocka ut');
				button.setAttribute('onclick', 'stopclock("annat");');
			}else{
				console.log('Något gick fel i "annantid()".');
			};
			var datum = document.getElementById('dateannan');
				datum.value = getDate().datum;
			var tid = document.getElementById('timeannan');
				tid.value = getDate().tid;
		};
		function numbertotext(num){var numsplit = num.split('');var result = [];for (var i = numsplit.length - 1; i >= 0; i--) {if(numsplit[i] == '0'){result.push('noll');}else if(numsplit[i] == '1'){result.push('ett');}else if(numsplit[i] == '2'){result.push('tva');}else if(numsplit[i] == '3'){result.push('tre');}else if(numsplit[i] == '4'){result.push('fyra');}else if(numsplit[i] == '5'){result.push('fem');}else if(numsplit[i] == '6'){result.push('sex');}else if(numsplit[i] == '7'){result.push('sju');}else if(numsplit[i] == '8'){result.push('atta');}else if(numsplit[i] == '9'){result.push('nio');}else{result.push('vetej');};};return result.join('');};
		function manadtotext(num){return config.manader[parseInt(num) - 1]};
		function loggsort(loggdata) {
			var allmillisec = [];
			for (var i = loggdata.length - 1; i >= 0; i--) {
				if(!loggdata[i].ut){
					var valtoadd = loggdata[i].in.milisec;
					var zerostoadd = loggdata[i].in.milisec.toString().split('');
					for (var a = zerostoadd.length - 1; a >= 0; a--) {
						var valtoadd = valtoadd + '0';
					};
				}else{
					var valtoadd = loggdata[i].in.milisec + '' + loggdata[i].ut.milisec;	
				};
				allmillisec.push(valtoadd);
			};
			allmillisec.sort();
			var sortedarray = [];
			for (var i = allmillisec.length - 1; i >= 0; i--) {
				var ammount = allmillisec[i].toString().length;
				var half =  ammount / 2;
				var inmillisec = allmillisec[i].slice(0, half);
				var utmillisec = allmillisec[i].slice(half, ammount);
				for (var a = loggdata.length - 1; a >= 0; a--) {
					if(loggdata[a].in.milisec == inmillisec){
						if(parseInt(utmillisec) == 0){
							sortedarray.push(loggdata[a]);
						}else if(loggdata[a].ut.milisec == utmillisec){
							sortedarray.push(loggdata[a]);
						};
					};
				};
			};
			return sortedarray;
		};
		function checkkey(e, id, focus){
			if (event.which == 13 || event.keyCode == 13) {
				document.getElementById(id).click();
				var selectelem = document.getElementById(focus);
					selectelem.focus();
					selectelem.select();
			};
		};
	</script>
	<style type="text/css">
		#header {
			font-size: 20px;
			vertical-align: top;
			text-align: center;
			width: 100%;
		}
		#head {
			font-weight: bold;
			font-family: verdana;
			text-align: center;
		}
		.table {
			display: table;
		}
		.tr {
			display: table-row;
		}
		.td{
			display: table-cell;
		}
		input, select, #klockadata {
			zoom: 1.5;
			margin: 5px;
		}
		#login, #projekt, #klocka, #klockaannantid, #loggwrapper{
			border: solid #000 3px;
		}
		#namn {
			text-align: left;
		}
		#projektnamn {
			text-align: right;
		}
		#loggwrapper{
			padding: 10px 10px 0px 10px;
		}
		#loggwrapper table{
			margin-bottom: 10px;
		}
		#loggwrapper table, #loggwrapper table td{
			border-collapse: collapse;
			border: solid 2px #000;
		}
		/*#loggwrapper table, #loggwrapper table tr{
			width: 100%;
			text-align: center;
		}
		#loggwrapper table tr:nth-child(0), #loggwrapper table tr:nth-child(1){
			text-align: left;
		}*/
	</style>
</head>
<body onload="load();">
	<div id="head">TidLogga</div>
	<div id="header" class="table">
		<div class="tr">
			<div id="namn" class="td">Välkommen XXXX</div>
			<div id="projektnamn" class="td">XXXXXXXXX</div>
		</div>
	</div>
	<div id="login">
		<input type="text" id="idnamn" onkeydown="checkkey(event, 'loginbutton', 'listaprojekt');" placeholder="VGR ID"><span id="namnstatus"></span><br/>
		<input type="button" value="Logga In" id="loginbutton" onclick="loggain();">
	</div>
	<div id="projekt">
		<select id="listaprojekt">
			<option value="none">Välj Projekt</option>
		</select><br/>
		<input type="button" value="Klocka" onclick="valjprojekt();"><input type="button" value="Logg" onclick="getlogg();"><input type="button" value="Skriv ut">
	</div>
	<div id="klocka">
		<div id="klockadata">
			<span id="intid">XX:XX</span> <span id="tid">XX:XX:XX</span>
		</div>
		<input type="button" value="Klocka in" class="in" onclick="startclock('nu')"><input type="button" value="Klocka ut" class="ut" onclick="stopclock('nu');">
		<div class="table">
			<div class="tr">
				<div class="td">
					<input type="button" class="in" value="Klocka in annan tid" onclick="annantid('in');"><input type="button" class="ut" value="Klocka ut annan tid" onclick="annantid('ut');">
				</div>
				<div class="td">
					<input type="button" value="Tillbaka" onclick="tillbakatillprojekt();">
				</div>
			</div>
		</div>
	</div>
	<div id="klockaannantid">
		<input type="date" id="dateannan"><input type="time" id="timeannan"><span id="datumstatus"></span><br/>
		<input type="button" id="annantidbutton" value="Klocka in/ut" onclick="startclock('annat')"><input type="button" id="annantidbutton" value="Avbryt" onclick="showhide('klockaannantid', 'klocka');">
	</div>
	<div id="loggwrapper">
		
	</div>



	<script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">
		//Tar server id enbart för att koppla till socket
		var geturl = window.location.href.replace('http://', '').split('/')[0];
		
		//Lyssnar om server säger något
		var socket = io.connect(geturl);

		// Visar i console log status från server
		socket.on('message', function(message) {
			console.log(message);
		});

		function loggain(){
			var nameinput = document.getElementById('idnamn').value;
			socket.emit('checkuser', nameinput);
		};

		socket.on('anvandare', function(responsdata) {
			console.log(responsdata);
			document.getElementById('tid').setAttribute('data-vgrid', responsdata.vgrid);
			var namn = document.getElementById('namn');
				removechilds(namn);
				var namntext = document.createTextNode('Välkommen ' + responsdata.namn);
				namn.appendChild(namntext);
			var listaprojekt = document.getElementById('listaprojekt');
			for (var a = 0; a < responsdata.projekt.length; a++){
				var option = document.createElement('option');
					option.setAttribute('value', responsdata.projekt[a]);
					var optiontext = document.createTextNode(config.projekt[responsdata.projekt[a]].namn);
					option.appendChild(optiontext);
				listaprojekt.appendChild(option);
			};
			showhide('none', 'namn');
			showhide('login', 'projekt');
		});

		socket.on('erroranvandare', function(message) {
			adderror('namnstatus', 'Användarnamn kunde inte hittas!');
			console.log('Användarnamn kunde inte hittas!');
		});

		function valjprojekt(){
			var select = document.getElementById('listaprojekt');
			var vgrid = document.getElementById('tid').getAttribute('data-vgrid');
			if(select.value == 'none'){}else{
				socket.emit('checkprojekt', {"projekt": select.value, "vgrid": vgrid, "getall": false, "checkaktiv": true});
			};
		};

		socket.on('svarprojekt', function(responsdata) {
			console.log(responsdata);
			var tidraknare = document.getElementById('tid');
					tidraknare.setAttribute('data-projektid', responsdata.projekt);
				var projektnamn = document.getElementById('projektnamn');
					removechilds(projektnamn);
					var projektnamntext = document.createTextNode(config.projekt[responsdata.projekt].namn);
					projektnamn.appendChild(projektnamntext);
				showhide('none', 'projektnamn');
				showhide('projekt', 'klocka');
			if(responsdata.svar == 'none'){
				enablebuttons('in')
				disablebuttons('ut')
			}else{
				startclock('save', responsdata.svar.milisec);
			};
		});

		function startclock(todo, startmilisec){
			disablebuttons('ut');
			disablebuttons('in');
			var save = false;
			if(todo == 'nu'){
				var datum = getDate();
			}else if(todo == 'annat'){
				var dateannan = document.getElementById('dateannan').value;
				var timeannan = document.getElementById('timeannan').value;
				var datum = getDate(dateannan, timeannan);
				showhide('klockaannantid', 'klocka');
			}else if(todo == 'save'){
				var datum = getDate('', '', startmilisec);
				var save = true;
			};
			var tidraknare = document.getElementById('tid');
			var projektid = tidraknare.getAttribute('data-projektid');
			var vgrid = tidraknare.getAttribute('data-vgrid');
			socket.emit('klockain', {"projekt": projektid, "vgrid": vgrid, "datum": datum, "save": save});
		};

		socket.on('startaklocka', function(inklockdata) {
			console.log(inklockdata);
			enablebuttons('ut');
			disablebuttons('in');
			var tidwrapper = document.getElementById('intid');
			removechilds(tidwrapper);
				var tidwrappertext = document.createTextNode(inklockdata.datum.tid);
				tidwrapper.appendChild(tidwrappertext);
			var tidraknare = document.getElementById('tid');
				tidraknare.setAttribute('data-milisec', inklockdata.datum.milisec);
			clearInterval(countinterval);
			startcount();
			countinterval = setInterval(function(){ startcount(); }, 1000);
		});


		function stopclock(todo){
			if(todo == 'nu'){
				var datum = getDate();
			}else if(todo == 'annat'){
				var dateannan = document.getElementById('dateannan').value;
				var timeannan = document.getElementById('timeannan').value;
				var datum = getDate(dateannan, timeannan);
			}else{
				console.log('Något gick fel i "stopclock()".');
			};
			var startmilisec = document.getElementById('tid').getAttribute('data-milisec');
			if(datum.milisec <= startmilisec){
				adderror('datumstatus', 'Du kan inte kocka ut innan du klockade in!');
			}else{
				disablebuttons('ut');
				disablebuttons('in');
				clearInterval(countinterval);
				showhide('klockaannantid', 'klocka');
				var tidraknare = document.getElementById('tid');
				var projektid = tidraknare.getAttribute('data-projektid');
				var startdatum = getDate('', '', tidraknare.getAttribute('data-milisec')).datum;
				var vgrid = tidraknare.getAttribute('data-vgrid');
				socket.emit('stopklocka', {"projekt": projektid, "vgrid": vgrid, "datum": datum, "startdatum": startdatum});
			};
		};

		socket.on('stopklocka', function(inklockdata) {
			enablebuttons('in');
			disablebuttons('ut');
		});

		function getlogg(specielltdatum){
			var select = document.getElementById('listaprojekt');
			var vgrid = document.getElementById('tid').getAttribute('data-vgrid');
			if(select.value == 'none'){}else{
				var loggwrapper = document.getElementById('loggwrapper');
				removechilds(loggwrapper);
				if(!specielltdatum){
					var datum = getDate().datum;
				}else{
					var datum = specielltdatum;
				};
				socket.emit('checkprojekt', {"projekt": select.value, "datum": datum, "vgrid": vgrid, "getall": true, "checkaktiv": false});
			};
			/*
			if(select.value == 'none'){}else{
				socket.emit('checkprojekt', {"projekt": select.value, "vgrid": vgrid, "getall": true});
			};
			var loggwrapper = document.getElementById('loggwrapper');
			removechilds(loggwrapper);
			*/
		};
		function loggandramanad(element){
			getlogg(element.value);
		};
		socket.on('sendlogg', function(loggdata) {
			var loggwrapper = document.getElementById('loggwrapper');
			var month = document.createElement('select');
				month.setAttribute('onchange', 'loggandramanad(this);');
			for (var a = 0; a < loggdata.mothtoload.length; a++){
				var option = document.createElement('option');
					option.setAttribute('value', loggdata.mothtoload[a]);
					var optiontext = document.createTextNode(loggdata.mothtoload[a]);
					option.appendChild(optiontext);
				month.appendChild(option);
			};
			loggwrapper.appendChild(month);
			var datumsplit = loggdata.datum.split('-');
			month.value = datumsplit[0] + '-' + datumsplit[1];
			var loggsorted = loggsort(loggdata.svar.data);
			var tableelem = document.createElement('table');
			console.log(loggdata.svar.data);
			for (var i = 0; i < loggsorted.length; i++){
				addlogglist(loggsorted[i], tableelem, loggdata.projekt, loggdata.vgrid);
			};
			loggwrapper.appendChild(tableelem);
			/*console.log(loggdata);
			var loggsorted = loggsort(loggdata.svar);
			for (var i = 0; i < loggsorted.length; i++){
				addwrapperelemlogg(loggsorted[i]);	
			};
			countday(loggdata.projekt);*/
		});
		function addlogglist(loggdata, tableelem, projektid, vgrid){
			var line = document.createElement('tr');
				line.setAttribute('data-vgrid', vgrid);
				line.setAttribute('data-projektid', projektid);
				line.setAttribute('data-milisecin', loggdata.in.milisec);
			if(!loggdata.ut){
				line.setAttribute('data-milisecut', 'none');
			}else{
				line.setAttribute('data-milisecut', loggdata.ut.milisec);
			};
				var tddatum = document.createElement('td');
					var tddatumtext = document.createTextNode(loggdata.in.datum);
					tddatum.appendChild(tddatumtext);
				line.appendChild(tddatum);
				var intid = document.createElement('td');
					var intidtext = document.createTextNode(loggdata.in.tid);
					intid.appendChild(intidtext);
				line.appendChild(intid);
				var uttid = document.createElement('td');
				if(!loggdata.ut){}else{
					var uttidtext = document.createTextNode(loggdata.ut.tid);
					uttid.appendChild(uttidtext);
				};
				line.appendChild(uttid);
				var totaltid = document.createElement('td');
				if(!loggdata.ut){}else{
					var time = timebetween(loggdata.in.milisec, loggdata.ut.milisec, '');
					var totaltidtext = document.createTextNode(addzero(time.t) + ':' + addzero(time.m) + ':' + addzero(time.s));
					totaltid.appendChild(totaltidtext);
				};
				line.appendChild(totaltid);
				var remove = document.createElement('td');
					var removeinput = document.createElement('img');
						removeinput.setAttribute('src', 'img/trash.png');
						removeinput.setAttribute('value', 'Ta bort');
						removeinput.setAttribute('class', 'loggbutton');
						removeinput.setAttribute('onclick', 'removesegment(this);');
					remove.appendChild(removeinput);
					if(!loggdata.ut){}else{
						var editinput = document.createElement('img');
							editinput.setAttribute('src', 'img/edit.png');
							editinput.setAttribute('value', 'Edit');
							editinput.setAttribute('class', 'loggbutton');
							editinput.setAttribute('onclick', 'edit(this);');
						remove.appendChild(editinput);
					};
				line.appendChild(remove);
			tableelem.appendChild(line);
		};
		function removesegment(element){
			var millisecin = element.parentElement.parentElement.getAttribute('data-milisecin');
			var millisecut = element.parentElement.parentElement.getAttribute('data-milisecut');
			var vgrid = element.parentElement.parentElement.getAttribute('data-vgrid');
			var projektid = element.parentElement.parentElement.getAttribute('data-projektid');
			var datum = getDate('', '', millisecin).datum;
			socket.emit('removesegment', {"millisecin": millisecin, "millisecut": millisecut, "vgrid": vgrid, "projektid": projektid, "datum": datum});
			var loggwrapper = document.getElementById('loggwrapper');
				removechilds(loggwrapper);
		};
		socket.on('elementremoved', function(loggdata) {
			getlogg(loggdata.datum);
		});
		function sparasegment(element){
			console.log(element);
		};
		/*
		function addwrapperelemlogg(loggdata){
			var loggwrapper = document.getElementById('loggwrapper');
			var datumsplit = loggdata.in.datum.split('-');
			var artext = 'loggar' + numbertotext(datumsplit[0]);
			var manadtext = 'loggar' + numbertotext(datumsplit[1]);
			var dagtext = 'loggar' + numbertotext(datumsplit[2]);
			var ar = document.getElementById(artext);
			if(!ar){
				var arelem = document.createElement('div');
					arelem.setAttribute('id', artext);
				loggwrapper.appendChild(arelem);
			};

			var manad = document.getElementById(artext + manadtext);
			if(!manad){
				var manadelem = document.createElement('table');
					manadelem.setAttribute('id', artext + manadtext);
					manadelem.setAttribute('class', artext + manadtext + dagtext);
					var trhead = document.createElement('tr');
						var tdhead = document.createElement('td');
							tdhead.setAttribute('colspan', config.forklaringar.length);
							var tdheadtext = document.createTextNode(datumsplit[0] + ' ' + manadtotext(parseInt(datumsplit[1])));
							tdhead.appendChild(tdheadtext);
						trhead.appendChild(tdhead);
					manadelem.appendChild(trhead);
					var trforklar = document.createElement('tr');
						for (var i = 0; i < config.forklaringar.length; i++){
							var tdforklar = document.createElement('td');
								var forklartext = document.createTextNode(config.forklaringar[i]);
								tdforklar.appendChild(forklartext);
							trforklar.appendChild(tdforklar);
						};
					manadelem.appendChild(trforklar);
				document.getElementById(artext).appendChild(manadelem);
			};

			var dag = document.getElementById(artext + manadtext + dagtext);
			if(!dag){
				var dagelem = document.createElement('tr');
					dagelem.setAttribute('id', artext + manadtext + dagtext);
					dagelem.setAttribute('class', artext + manadtext + dagtext);
					if(!loggdata.ut){
						dagelem.setAttribute('data-milisec', '0');
					}else{
						dagelem.setAttribute('data-milisec', parseInt(loggdata.ut.milisec) - parseInt(loggdata.in.milisec));
					};
					var datum = document.createElement('td');
						datum.setAttribute('rowspan', '1');
						var datumtext = document.createTextNode(loggdata.in.datum);
						datum.appendChild(datumtext);
					dagelem.appendChild(datum);
					addinfologg(dagelem, loggdata);
					var samdag = document.createElement('td');
						samdag.setAttribute('class', 'samdag');
					dagelem.appendChild(samdag);
				document.getElementById(artext + manadtext).appendChild(dagelem);
			}else{
				var datumelem = dag.getElementsByTagName('td')[0];
				var rowspan = parseInt(datumelem.getAttribute('rowspan')) + 1;
					datumelem.setAttribute('rowspan', rowspan);
				var samdag = dag.getElementsByClassName('samdag')[0];
					samdag.setAttribute('rowspan', rowspan);
				var dagelem = document.createElement('tr');
					dagelem.setAttribute('class', artext + manadtext + dagtext);
					dagelem.setAttribute('data-milisec', parseInt(loggdata.ut.milisec) - parseInt(loggdata.in.milisec));
					addinfologg(dagelem, loggdata);
				var allrows = document.getElementsByClassName(artext + manadtext + dagtext)
				console.log(allrows[0]);
				allrows[0].insertBefore(dagelem, allrows[allrows.length - 1].nextSibling);
			};
		};

		function addinfologg(elem, loggdata){
			var tidin = document.createElement('td');
				var tidintext = document.createTextNode(loggdata.in.tid);
				tidin.appendChild(tidintext);
			elem.appendChild(tidin);
			var tidut = document.createElement('td');
			if(!loggdata.ut){
				var tiduttext = document.createTextNode('XX:XX');
				tidut.appendChild(tiduttext);
			}else{
				var tiduttext = document.createTextNode(loggdata.ut.tid);
				tidut.appendChild(tiduttext);
			};
			elem.appendChild(tidut);
			var tidmellan = document.createElement('td');
			if(!loggdata.ut){}else{
				var timedata = timebetween(loggdata.in.milisec, loggdata.ut.milisec);
				var tidmellantext = document.createTextNode(addzero(timedata.t) + ':' + addzero(timedata.m) + ':' + addzero(timedata.s));
				tidmellan.appendChild(tidmellantext);
			};
			elem.appendChild(tidmellan);
		};

		function countday(projektid){
			var wrapper = document.getElementById('loggwrapper');
			var alltables = wrapper.getElementsByTagName('table');
			for (var b = alltables.length - 1; b >= 0; b--) {
				var alllines = alltables[b].getElementsByTagName('tr');
				console.log(alllines);
				var samanlagtmanad = 0;
				for (var i = alllines.length - 1; i >= 0; i--) {
					if(!alllines[i].getAttribute('id')){}else{
						var allelementsday = document.getElementsByClassName(alllines[i].getAttribute('id'));
						var count = 0;
						for (var a = allelementsday.length - 1; a >= 0; a--) {
							if(!allelementsday[a].getAttribute('data-milisec')){}else{
								var count = count + parseInt(allelementsday[a].getAttribute('data-milisec'));
							};
						};
						console.log(count);
						var samanlagtmanad = samanlagtmanad + count;
						var tidraknat = timebetween('', '', count);
						var samdagtext = document.createTextNode(addzero(tidraknat.t) + ':' + addzero(tidraknat.m) + ':' + addzero(tidraknat.s));
						alllines[i].getElementsByClassName('samdag')[0].appendChild(samdagtext);
					};
				};
				var sammanmanval = timebetween('', '', samanlagtmanad);
				var sammanlagtmanadelem = document.createElement('td');
					sammanlagtmanadelem.setAttribute('rowspan', alllines.length - 2);
					var sammanlagtmanadtext = document.createTextNode(addzero(sammanmanval.t) + ':' + addzero(sammanmanval.m) + ':' + addzero(sammanmanval.s));
					sammanlagtmanadelem.appendChild(sammanlagtmanadtext);
				alllines[2].appendChild(sammanlagtmanadelem);
				var tdprojekt = document.createElement('td');
					tdprojekt.setAttribute('rowspan', alllines.length - 2);
					var tdprojekttext = document.createTextNode(config.projekt[projektid].namn);
					tdprojekt.appendChild(tdprojekttext);
				alllines[2].insertBefore(tdprojekt, alllines[2].childNodes[0]); 
			};
		};*/
	</script>
</body>
</html>